@model IEnumerable<ShopOnline.Models.Product>

@{
    ViewBag.Title = "Shop";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section id="banner"></section>

<section id="hero">
    <h1>Products</h1>
    <p>Home / Products</p>
    <hr />
</section>

<div class="shop-container">
    <!-- Sidebar -->
    <aside id="sidebar">
        <ul class="sidebar-menu">
            <li class="sidebar-item">
                <button class="sidebar-btn">Collections <i class="fa-solid fa-chevron-down"></i></button>
                <ul class="submenu">
                    @* --- Dùng DB để render danh mục --- *@
                    @foreach (var cate in ViewBag.Categories)
                    {
                        var activeClass = (ViewBag.CurrentCategory == cate.IDCate) ? "active-category" : ""; // toán tử 3 ngôi
                                                                                                             //condition ? value_if_true : value_if_false
                                                                                                             //Nếu danh mục hiện tại (user đang chọn) bằng cate.IDCate → gán class "active-category"

                        <li>
                            @* active class là biến c# *@
                            <a class="@activeClass"
                               href="@Url.Action("Shop", "TrangChu", new { idCate = cate.IDCate })">
                                @cate.NameCate
                            </a>
                        </li>
                    }
                </ul>
            </li>

            <li class="sidebar-item">
                <button class="sidebar-btn">Availability <i class="fa-solid fa-chevron-down"></i></button>
                <ul class="submenu">
                    <li><a href="@Url.Action("Shop", "TrangChu")">In Stock</a></li>
                    <li><a href="#">Out of Stock</a></li>
                </ul>
            </li>

            <li class="sidebar-item">
                <button class="sidebar-btn">Product <i class="fa-solid fa-chevron-down"></i></button>
                <ul class="submenu">
                    <li><a href="#">New Arrivals</a></li>
                    <li><a href="@Url.Action("Bestseller", "TrangChu")">BESTSELLERS</a></li>
                </ul>
            </li>
        </ul>
    </aside>

    <!-- Product -->
    <section id="product1">
        <div class="pro-container">
            @* lặp qua @model IEnumerable<ShopOnline.Models.Product>*@
            @foreach (var item in Model)
            {
                <div class="pro">
                    <a href="@Url.Action("DetailShop", "Detail", new { id = item.ProductID })">
                        <img src="@Url.Content("~/pictures/tshirt/" + item.ImagePro)" alt="@item.NamePro" />
                    </a>
                    <div class="des">
                        <h5>@item.NamePro</h5>
                        <h4>@String.Format("{0:N0}₫", item.Price)</h4>
                    </div>
                </div>
            }
        </div>
    </section>
</div>

<section id="pagination" class="section-p1">
    <hr id="line" />
    <div class="pages">
        <a href="@Url.Action("Shop", "TrangChu")">1</a>
        <a href="@Url.Action("Shop", "TrangChu")">2</a>
        <a href="@Url.Action("Shop", "TrangChu")">3</a>
        <a href="@Url.Action("Shop", "TrangChu")"><i class="fa-solid fa-greater-than"></i></a>
    </div>
</section>

@*  script sidebar  *@

<script>
    document.addEventListener("DOMContentLoaded", function () {

        // Lấy tất cả các button trong sidebar
        const sidebarButtons = document.querySelectorAll(".sidebar-btn");

        sidebarButtons.forEach(btn => {
            btn.addEventListener("click", function () {

                const submenu = this.nextElementSibling; // submenu liền sau button

                // Nếu submenu đang mở -> đóng lại
                if (submenu.style.maxHeight) {
                    submenu.style.maxHeight = null;
                }
                // Nếu submenu đang đóng -> mở ra
                else {
                    submenu.style.maxHeight = submenu.scrollHeight + "px";

                    // scrollHeight: Chiều cao thật của nội dung bên trong element, kể cả phần bị ẩn.
                }

                // Xoay icon
                this.classList.toggle("active");

                //.toggle() = Nếu có class thì xóa – nếu chưa có thì thêm.
            });
        });

    });
</script>